YUI.add("moodle-availability_examus2-form",function(ue,e){M.availability_examus2=M.availability_examus2||{},M.availability_examus2.form=ue.Object(M.core_availability.plugin),M.availability_examus2.form.rules=null,M.availability_examus2.form.initInner=function(e,a,n,i,t){this.rules=e,this.warnings=a,this.scoring=n,this.defaults=i,this.groups=t},M.availability_examus2.form.instId=0,M.availability_examus2.form.getNode=function(e){var n,a,i,c,t,u,m,p,b,f,h,g,v,_,y,k,w,x,A,P,q,C,F,N,S,E,T,I,L,O,R,j,D,J,V,H,$,z,B,U,Y,G,l,o,K,Q,s,W,X,Z,ee,ae,ne,ie,te,le,oe;function r(e,a){return a=a||"availability_examus2",M.util.get_string(e,a)}function se(e){var a=r("showmore","core_form"),n=r("showless","core_form");return'<a href="#" class="examus2-moreless" data-more="'+a+'" data-less="'+n+'">'+a+'</a><div class="hidden col-md-12">'+e+"</div>"}function d(e,a,n,i,t){var l=t?10:5,t=t?10:7;return'<span class="availability-group form-group mb-2"><div class="col-md-'+l+' col-form-label d-flex flex-nowrap pb-0 pr-md-0">  <label for="'+e+'">'+a+'</label></div><div class="col-md-'+t+' form-inline align-items-center flex-nowrap felement">'+i+(n?'<a class="btn btn-link p-0 ml-2" role="button" data-container="body" data-toggle="popover" data-placement="right" data-content="<div class=&quot;no-overflow&quot;><p>'+n+'</p></div> " data-html="true" tabindex="0" data-trigger="focus" data-original-title="" title=""><i class="icon fa fa-question-circle text-info fa-fw " title="'+r("hint")+'" aria-label="'+r("hint")+'"> </i></a>':"")+"</div></span>"}function re(e){setTimeout(e,0)}function de(e){1==e?(S.addClass("btn-primary"),S.removeClass("btn-secondary"),E.addClass("btn-secondary"),E.removeClass("btn-primary"),T.removeClass("hidden"),I.addClass("hidden")):(E.addClass("btn-primary"),E.removeClass("btn-secondary"),S.addClass("btn-secondary"),S.removeClass("btn-primary"),T.addClass("hidden"),I.removeClass("hidden"))}for(O in M.availability_examus2.form.instId+=1,c=(a="examus2"+M.availability_examus2.form.instId)+"_mode",t=a+"_schedulingRequired",u=a+"_autoRescheduling",m=a+"_isTrial",l=a+"_identification",p=a+"_customRules",b=a+"_auxCamera",K=a+"_auxiliaryCameraMode",f=a+"_allowmultipledisplays",h=a+"_faceHuntingEnabled",g=a+"_allowMobileDevices",v=a+"_allowvirtualenvironment",_=a+"_checkidphotoquality",y=a+"_ldb",k=a+"_biometryEnabled",w=a+"_biometrySkipfail",x=a+"_biometryFlow",A=a+"_biometryTheme",P=a+"_userAgreement",o=a+"_webCameraMainView",q=a+"_enabledForbiddenProcesses",C=a+"_desktopAppForbiddenProcesses",F=a+"_enabledAllowedProcesses",N=a+"_desktopAppAllowedProcesses",i=d(i=a+"_duration",r("duration"),r("duration_desc"),'<input type="text" name="duration" style="flex-wrap: nowrap;" id="'+i+'" class="form-control">'),i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i+=d(c,r("proctoring_mode"),r("proctoring_mode_desc"),'<select name="mode" id="'+c+'" class="custom-select">  <option value="online">'+r("online_mode")+'</option>  <option value="identification">'+r("identification_mode")+'</option>  <option value="offline">'+r("offline_mode")+'</option>  <option value="auto">'+r("auto_mode")+"</option></select>"))+d(l,r("identification"),r("identification_desc"),'<select name="identification" id="'+l+'" class="custom-select">  <option value="passport">'+r("passport_identification")+'</option>  <option value="face">'+r("face_identification")+'</option>  <option value="face_and_passport">'+r("face_passport_identification")+'</option>  <option value="skip">'+r("skip_identification")+"</option></select>"))+d(o,r("web_camera_main_view"),"",'<select name="webcameramainview" id="'+o+'" class="custom-select">  <option value="front">'+r("web_camera_main_view_front")+'</option>  <option value="side">'+r("web_camera_main_view_side")+"</option></select>"))+d(t,r("scheduling_required"),r("scheduling_required_desc"),'<input type="checkbox" name="scheduling_required" id="'+t+'" value="1">&nbsp;<label for="'+t+'">'+r("enable")+"</label> "))+d(u,r("auto_rescheduling"),r("auto_rescheduling_desc"),'<input type="checkbox" name="auto_rescheduling" id="'+u+'" value="1">&nbsp;<label for="'+u+'">'+r("enable")+"</label> "))+d(m,r("is_trial"),r("is_trial_desc"),'<input type="checkbox" name="istrial" id="'+m+'" value="1">&nbsp;<label for="'+m+'">'+r("enable")+"</label> "))+d(b,r("auxiliary_camera"),r("auxiliary_camera_desc"),'<input type="checkbox" name="auxiliarycamera" id="'+b+'" value="1">&nbsp;<label for="'+b+'">'+r("enable")+"</label> "))+d(K,r("auxiliary_camera_mode"),"",'<select name="auxiliarycameramode" id="'+K+'" class="custom-select">  <option value="video">'+r("auxiliary_camera_mode_video")+'</option>  <option value="photo">'+r("auxiliary_camera_mode_photo")+"</option></select>"))+d(y,r("enable_ldb"),r("enable_ldb_desc"),'<input type="checkbox" name="ldb" id="'+y+'" value="1">&nbsp;<label for="'+y+'">'+r("enable")+"</label> "))+d(f,r("allowmultipledisplays"),"",'<input type="checkbox" name="allowmultipledisplays" id="'+f+'" value="1">&nbsp;<label for="'+f+'">'+r("enable")+"</label> "))+d(h,r("facehuntingenabled"),"",'<input type="checkbox" name="facehuntingenabled" id="'+h+'" value="1">&nbsp;<label for="'+h+'">'+r("enable")+"</label> "))+d(g,r("allowmobiledevices"),"",'<input type="checkbox" name="allowmobiledevices" id="'+g+'" value="1">&nbsp;<label for="'+g+'">'+r("enable")+"</label> "))+d(v,r("allowvirtualenvironment"),"",'<input type="checkbox" name="allowvirtualenvironment" id="'+v+'" value="1">&nbsp;<label for="'+v+'">'+r("enable")+"</label> "))+d(_,r("checkidphotoquality"),"",'<input type="checkbox" name="checkidphotoquality" id="'+_+'" value="1">&nbsp;<label for="'+_+'">'+r("enable")+"</label> "))+d(P,r("user_agreement_url"),r("user_agreement_url_desc"),'<input name="useragreementurl" id="'+P+'" class="form-control" value="" />'))+d(p,r("custom_rules"),r("custom_rules_desc"),'<textarea name="customrules" id="'+p+'" class="form-control"></textarea>'))+d(q,r("enabledForbiddenProcesses"),"",
'<input type="checkbox" name="enabledForbiddenProcesses" id="'+q+'" value="0">&nbsp;<label for="'+q+'">'+r("enable")+"</label> "))+d(C,r("desktop_app_forbidden_processes"),r("desktop_app_forbidden_processes_desc"),'<textarea name="desktopAppForbiddenProcesses" id="'+C+'" class="form-control"></textarea>'))+d(F,r("enabledAllowedProcesses"),"",'<input type="checkbox" name="enabledAllowedProcesses" id="'+F+'" value="0">&nbsp;<label for="'+F+'">'+r("enable")+"</label> "))+d(N,r("desktop_app_allowed_processes"),r("desktop_app_allowed_processes_desc"),'<textarea name="desktopAppAllowedProcesses" id="'+N+'" class="form-control"></textarea>'),L="",this.rules)L=(L+='<div style="display:flex;gap:4px;margin-bottom:4px;"><input type="checkbox" name="'+O+'" id="'+(R=a+"_"+O)+'" value="'+O+'" >&nbsp;')+'<label for="'+R+'" style="white-space: break-spaces">'+r(O)+"</label></div>";if(i+=d(null,r("rules"),r("rules_desc"),'<div class="rules" style="white-space:nowrap">'+L+"</div>"),this.groups){for(D in j="",this.groups)J=this.groups[D].name,V=e.groups instanceof Array?e.groups:[],j+="<br><label><input value="+(a=parseInt(this.groups[D].id))+' type="checkbox" name=groups[] '+(-1<(V=V.map(function(e){return parseInt(e)})).indexOf(a)?"checked":"")+">&nbsp;"+J+"</label>";i+=d(null,r("select_groups"),r("select_groups_desc"),'<div class="groups"'+j+"</div>")}for($ in H="",this.warnings)H=(H+='<div style="display:flex;gap:4px;margin-bottom:4px;"><input type="checkbox" name="'+$+'" id="'+(z=a+"_"+$)+'" value="'+$+'" >&nbsp;')+'<label for="'+z+'" style="white-space: break-spaces">'+r($)+"</label></div>";for(U in B="",this.scoring)G='<input type="number" class="examus2-scoring-input" value=""step="0.01" name="'+U+'"id="scoring_'+(Y=a+"_"+U)+'"min="'+this.scoring[U].min+'" max="'+this.scoring[U].max+'">',B+=d(Y,r("scoring_"+U),"",G);if(l="",l=(l=(l=(l+=d(k,r("biometry_enabled"),"",'<input type="checkbox" name="biometryenabled" id="'+k+'" value="1">&nbsp;<label for="'+k+'">'+r("enable")+"</label> "))+d(w,r("biometry_skipfail"),"",'<input type="checkbox" name="biometryskipfail" id="'+w+'" value="1">&nbsp;<label for="'+w+'">'+r("enable")+"</label> "))+d(x,r("biometry_flow"),"",'<input type="text" name="biometryflow" id="'+x+'" class="form-control">'))+d(A,r("biometry_theme"),"",'<input type="text" name="biometrytheme" id="'+A+'" class="form-control">'),o="",o=(o=(o+=d(null,r("visible_warnings"),r("visible_warnings_desc"),'<div class="warnings" style="white-space: nowrap" >'+se(H)+"</div>",!0))+d(null,r("scoring_params_header"),r("scoring_params_header_desc"),se(B),!0))+d(null,r("biometry_header"),"",se(l),!0),(n=ue.Node.create('<span class="availability_examus2-tabs" style="position:relative"></span>')).setHTML("<label><strong>"+r("title")+"</strong></label><br><br>"),K=ue.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availability_examus2-tab-btns"></div>').appendTo(n),S=ue.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo(K),E=ue.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo(K),T=ue.Node.create('<div class="tab_content">'+i+"</div>").appendTo(n),I=ue.Node.create('<div class="tab_content hidden">'+o+"</div>").appendTo(n),e.rules===undefined&&(e.rules=this.rules),e.warnings===undefined&&(e.warnings=this.warnings),e.scoring=e.scoring||{},e.creating){for(Q in this.defaults)if(s=this.defaults[Q],"scoring"==Q)for(W in s)e.scoring[W]=s[W]?parseFloat(s[W]):null;else if("rules"==Q)for(X in s)e.rules[X]=s[X];else if("warnings"==Q)for(Z in s)e.warnings[Z]=!!s[Z];else e[Q]=s;e.mode||(e.mode="online",e.scheduling_required=!0)}for(ee in e.duration!==undefined&&n.one("input[name=duration]").set("value",e.duration),e.mode!==undefined&&n.one("select[name=mode] option[value="+e.mode+"]").set("selected","selected"),e.identification!==undefined&&n.one("select[name=identification] option[value="+e.identification+"]").set("selected","selected"),e.webcameramainview&&n.one("select[name=webcameramainview] option[value="+e.webcameramainview+"]").set("selected","selected"),e.auto_rescheduling!==undefined&&n.one("#"+u).set("checked",e.auto_rescheduling?"checked":null),e.istrial!==undefined&&(l=e.istrial?"checked":null,n.one("#"+m).set("checked",l)),e.auxiliarycamera!==undefined&&n.one("#"+b).set("checked",e.auxiliarycamera?"checked":null),e.auxiliarycameramode&&n.one("select[name=auxiliarycameramode] option[value="+e.auxiliarycameramode+"]").set("selected","selected"),e.ldb!==undefined&&n.one("#"+y).set("checked",e.ldb?"checked":null),e.scheduling_required!==undefined&&n.one("#"+t).set("checked",e.scheduling_required?"checked":null),e.allowmultipledisplays!==undefined&&n.one("#"+f).set("checked",e.allowmultipledisplays?"checked":null),e.facehuntingenabled!==undefined&&n.one("#"+h).set("checked",e.facehuntingenabled?"checked":null),e.allowmobiledevices!==undefined&&n.one("#"+g).set("checked",e.allowmobiledevices?"checked":null),e.allowvirtualenvironment!==undefined&&n.one("#"+v).set("checked",e.allowvirtualenvironment?"checked":null),e.checkidphotoquality!==undefined&&n.one("#"+_).set("checked",e.checkidphotoquality?"checked":null),e.biometryenabled!==undefined&&n.one("#"+k).set("checked",e.biometryenabled?"checked":null),e.biometryskipfail!==undefined&&n.one("#"+w).set("checked",e.biometryskipfail?"checked":null),e.biometryflow!==undefined&&n.one("#"+x).set("value",e.biometryflow),e.biometrytheme!==undefined&&n.one("#"+A).set("value",e.biometrytheme),this.warnings)e.warnings[ee]===undefined&&(e.warnings[ee]=this.warnings[ee]);for(ae in e.warnings)e.warnings[ae]&&(ne=n.one(".warnings input[name="+ae+"]"))&&ne.set("checked","checked");for(ie in e.rules)e.rules[ie]&&(te=n.one(".rules input[name="+ie+"]"))&&te.set("checked","checked");for(le in e.scoring)isNaN(e.scoring[le])||(oe=n.one(".examus2-scoring-input[name="+le+"]"))&&oe.set("value",e.scoring[le]);if(e.customrules!==undefined&&n.one("#"+p).set("value",e.customrules),e.enabledForbiddenProcesses!==undefined&&n.one("#"+q).set(
"checked",e.enabledForbiddenProcesses?"checked":null),e.desktopAppForbiddenProcesses!==undefined){try{n.one("#"+C).set("value",JSON.parse(e.desktopAppForbiddenProcesses).join("\n"))}catch(ce){n.one("#"+C).set("value",e.desktopAppForbiddenProcesses)}n.one("#"+C).set("disabled",n.one("#"+q).get("checked")?null:"disabled")}if(e.enabledAllowedProcesses!==undefined&&n.one("#"+F).set("checked",e.enabledAllowedProcesses?"checked":null),e.desktopAppAllowedProcesses!==undefined){try{n.one("#"+N).set("value",JSON.parse(e.desktopAppAllowedProcesses).join("\n"))}catch(ce){n.one("#"+N).set("value",e.desktopAppAllowedProcesses)}n.one("#"+N).set("disabled",n.one("#"+F).get("checked")?null:"disabled")}return e.useragreementurl!==undefined&&n.one("#"+P).set("value",e.useragreementurl),n.delegate("valuechange",function(){re(function(){M.core_availability.form.update()})},"input,textarea,select"),n.delegate("click",function(){re(function(){M.core_availability.form.update()})},"input[type=checkbox]"),n.delegate("valuechange",function(){var e,a;e=["online","identification"],a=n.one("select[name=mode]").get("value").trim(),a=0<=e.indexOf(a),n.one("#"+t).set("checked",a)},"#"+c),S.on("click",function(e){e.preventDefault(),de(1)}),E.on("click",function(e){e.preventDefault(),de(2)}),n.delegate("click",function(e){var a;e.preventDefault(),e=e.target,a=e.next(),a.hasClass("hidden")?(a.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(a.addClass("hidden"),e.setContent(e.getAttribute("data-more")))},".examus2-moreless"),n},M.availability_examus2.form.fillValue=function(n,e){var a,i,t;n.duration=e.one("input[name=duration]").get("value").trim(),n.mode=e.one("select[name=mode]").get("value").trim(),n.identification=e.one("select[name=identification]").get("value").trim(),n.auxiliarycameramode=e.one("select[name=auxiliarycameramode]").get("value").trim(),n.webcameramainview=e.one("select[name=webcameramainview]").get("value").trim(),n.auto_rescheduling=e.one("input[name=auto_rescheduling]").get("checked"),n.scheduling_required=e.one("input[name=scheduling_required]").get("checked"),n.istrial=e.one("input[name=istrial]").get("checked"),n.customrules=e.one("textarea[name=customrules]").get("value").trim(),n.enabledForbiddenProcesses=e.one("input[name=enabledForbiddenProcesses]").get("checked"),n.desktopAppForbiddenProcesses=JSON.stringify(e.one("textarea[name=desktopAppForbiddenProcesses]").get("value").split("\n").filter(function(e){return e.trim()})),n.enabledAllowedProcesses=e.one("input[name=enabledAllowedProcesses]").get("checked"),n.desktopAppAllowedProcesses=JSON.stringify(e.one("textarea[name=desktopAppAllowedProcesses]").get("value").split("\n").filter(function(e){return e.trim()})),n.useragreementurl=e.one("input[name=useragreementurl]").get("value").trim(),n.auxiliarycamera=e.one("input[name=auxiliarycamera]").get("checked"),n.ldb=e.one("input[name=ldb]").get("checked"),n.allowmultipledisplays=e.one("input[name=allowmultipledisplays]").get("checked"),n.facehuntingenabled=e.one("input[name=facehuntingenabled]").get("checked"),n.allowmobiledevices=e.one("input[name=allowmobiledevices]").get("checked"),n.allowvirtualenvironment=e.one("input[name=allowvirtualenvironment]").get("checked"),n.checkidphotoquality=e.one("input[name=checkidphotoquality]").get("checked"),n.biometryenabled=e.one("input[name=biometryenabled]").get("checked"),n.biometryskipfail=e.one("input[name=biometryskipfail]").get("checked"),n.biometryflow=e.one("input[name=biometryflow]").get("value").trim(),n.biometrytheme=e.one("input[name=biometrytheme]").get("value").trim(),n.rules={},a=e.all(".rules input"),ue.each(a,function(e){t=e.get("value"),!0===e.get("checked")?n.rules[t]=!0:n.rules[t]=!1}),document.addEventListener("click",function(e){"enabledForbiddenProcesses"==e.target.name&&(e.target.checked?document.querySelector("textarea[name=desktopAppForbiddenProcesses]").disabled=!1:document.querySelector("textarea[name=desktopAppForbiddenProcesses]").disabled="disabled"),"enabledAllowedProcesses"==e.target.name&&(e.target.checked?document.querySelector("textarea[name=desktopAppAllowedProcesses]").disabled=!1:document.querySelector("textarea[name=desktopAppAllowedProcesses]").disabled="disabled")}),n.warnings={},i=e.all(".warnings input"),ue.each(i,function(e){t=e.get("value"),!0===e.get("checked")?n.warnings[t]=!0:n.warnings[t]=!1}),n.scoring={},i=e.all(".examus2-scoring-input"),ue.each(i,function(e){t=e.get("name");e=e.get("value").trim();0<e.length?n.scoring[t]=parseFloat(e):n.scoring[t]=null}),n.groups=[],a=e.all(".groups input"),ue.each(a,function(e){var a=e.get("value");!0===e.get("checked")&&n.groups.push(a)})},M.availability_examus2.form.fillErrors=function(e,a){var n,i={};this.fillValue(i,a),n=document.getElementById("duration_error"),i.duration!==undefined&&new RegExp("^\\d+$").test(i.duration)&&i.duration%30==0||n?i.duration!==undefined&&new RegExp("^\\d+$").test(i.duration)&&i.duration%30==0&&n&&n.remove():(i=a._node.querySelector('input[name="duration"]').parentNode.parentNode,(n=document.createElement("span")).style.color="red",n.style.fontSize="11px",n.innerHTML=M.util.get_string("error_setduration","availability_examus2"),n.classList.add("col-md-10"),n.classList.add("col-form-label"),n.classList.add("d-flex"),n.classList.add("mb-1"),n.classList.add("pt-0"),n.id="duration_error",i.insertAdjacentElement("afterend",n))}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});