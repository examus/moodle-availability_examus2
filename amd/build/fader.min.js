/**
 * Availability plugin for integration with Examus.
 *
 * @module     availability_examus2/fader
 * @copyright  2019-2023 Maksim Burnin <maksim.burnin@gmail.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("availability_examus2/fader",["core/str","core/notification"],(function(str,notification){return{init:function(formData,reset){const TAG="proctoring fader",proved=new Promise((resolve=>{const messageHandler=e=>{console.debug(TAG,"got some message",e.data),"proctoringReady_n6EY"===e.data&&(resolve(),console.debug(TAG,"got proving message",e.data),window.removeEventListener("message",messageHandler))};window.addEventListener("message",messageHandler)}));str.get_strings([{key:"fader_awaiting_proctoring",component:"availability_examus2"},{key:"fader_instructions",component:"availability_examus2"},{key:"fader_reset",component:"availability_examus2"}]).done((function(s){const faderHTML=s[0]+s[1],strReset=s[2],fader=(html=>{const fader=document.createElement("div");return fader.innerHTML=html,Object.assign(fader.style,{position:"fixed",zIndex:1e3,fontSize:"2em",width:"100%",height:"100%",background:"#fff",top:0,left:0,textAlign:"center",display:"flex",justifyContent:"center",alignContent:"center",flexDirection:"column"}),document.body.appendChild(fader),fader})(faderHTML),redirectTimeout=setTimeout((()=>{(()=>{if(!formData)return;const form=document.createElement("form"),input=document.createElement("input");form.appendChild(input),document.body.appendChild(form),form.method=formData.method,form.action=formData.action,input.name="token",input.value=formData.token,form.submit()})()}),15e3);proved.then((()=>{reset?fader.innerHTML=strReset:fader.remove(),clearTimeout(redirectTimeout)}))})).fail(notification.exception)}}}));

//# sourceMappingURL=fader.min.js.map